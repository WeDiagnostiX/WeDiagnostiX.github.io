(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[497],{10424:(t,o,e)=>{"use strict";e.d(o,{Z:()=>u});var n=e(33232),i=e(62709);const r="viewport-element";function s(t,o){if(n.SB.svgNodeCache[t])return n.SB.svgNodeCache[t][o]?n.SB.svgNodeCache[t][o].domRef:void 0}function a(t,o,e,i){if(!n.SB.svgNodeCache[o])return null;n.SB.svgNodeCache[o][i]={touched:!0,domRef:e},t.appendChild(e)}function l(t,o){n.SB.svgNodeCache[t]&&n.SB.svgNodeCache[t][o]&&(n.SB.svgNodeCache[t][o].touched=!0)}function d(t,o){n.SB.svgNodeCache[o]&&Object.keys(n.SB.svgNodeCache[o]).forEach((e=>{const i=n.SB.svgNodeCache[o][e];!i.touched&&i.domRef&&(t.removeChild(i.domRef),delete n.SB.svgNodeCache[o][e])}))}const c=function(t){const o=(0,i.getEnabledElement)(t),{viewportId:e,renderingEngineId:c}=o,u=`${e}:${c}`,h=function(t){const o=`.${r}`,e=t.querySelector(o);return e.querySelector(":scope > .svg-layer")}(t);return Object.keys(n.SB.svgNodeCache[u]).forEach((t=>{n.SB.svgNodeCache[u][t].touched=!1})),{svgLayerElement:h,svgNodeCacheForCanvas:n.SB.svgNodeCache,getSvgNode:s.bind(this,u),appendNode:a.bind(this,h,u),setNodeTouched:l.bind(this,u),clearUntouched:d.bind(this,h,u)}};const u=function(t,o){const e=c(t);o(e),e.clearUntouched()}},22712:(t,o,e)=>{"use strict";var n;e.d(o,{default:()=>i}),function(t){t.Active="Active",t.Passive="Passive",t.Enabled="Enabled",t.Disabled="Disabled"}(n||(n={}));const i=n},36048:(t,o,e)=>{"use strict";e.d(o,{Z:()=>y});var n=e(33232),i=e(68096),r=e(20346),s=e.n(r),a=e(11677),l=e.n(a),d=e(62709),c=e(60020),u=e(23118);const{Active:h,Passive:g,Enabled:p,Disabled:f}=i.ToolModes,v=[{mouseButton:i.MouseBindings.Primary}];class m{constructor(t){this.viewportsInfo=[],this.toolOptions={},this.currentActivePrimaryToolName=null,this.prevActivePrimaryToolName=null,this.restoreToolOptions={},this._toolInstances={},this.id=t}getViewportIds(){return this.viewportsInfo.map((({viewportId:t})=>t))}getViewportsInfo(){return this.viewportsInfo.slice()}getToolInstance(t){const o=this._toolInstances[t];if(o)return o;console.warn(`'${t}' is not registered with this toolGroup (${this.id}).`)}getToolInstances(){return this._toolInstances}hasTool(t){return!!this._toolInstances[t]}addTool(t,o={}){const e=n.SB.tools[t],i=void 0!==t&&""!==t,r=this.toolOptions[t];if(!i)return void console.warn("Tool with configuration did not produce a toolName: ",o);if(!e)return void console.warn(`'${t}' is not registered with the library. You need to use cornerstoneTools.addTool to register it.`);if(r)return void console.warn(`'${t}' is already registered for ToolGroup ${this.id}.`);const{toolClass:s}=e,a=new s({name:t,toolGroupId:this.id,configuration:o});this._toolInstances[t]=a}addToolInstance(t,o,e={}){let i=n.SB.tools[t]?.toolClass;if(!i){const e=n.SB.tools[o].toolClass;class r extends e{}r.toolName=t,i=r,n.SB.tools[t]={toolClass:r}}this.addTool(i.toolName,e)}addViewport(t,o){if("string"!=typeof t)throw new Error("viewportId must be defined and be a string");const e=(0,d.getRenderingEngines)();if(!o&&e.length>1)throw new Error("You must specify a renderingEngineId when there are multiple rendering engines.");const n=o||e[0].id;this.viewportsInfo.some((({viewportId:o})=>o===t))||this.viewportsInfo.push({viewportId:t,renderingEngineId:n});const r=this.getActivePrimaryMouseButtonTool();d.Settings.getRuntimeSettings().get("useCursors")&&this.setViewportsCursorByToolName(r);const s={toolGroupId:this.id,viewportId:t,renderingEngineId:n};(0,d.triggerEvent)(d.eventTarget,i.Events.TOOLGROUP_VIEWPORT_ADDED,s)}removeViewports(t,o){const e=[];if(this.viewportsInfo.forEach(((n,i)=>{let r=!1;n.renderingEngineId===t&&(r=!0,o&&n.viewportId!==o&&(r=!1)),r&&e.push(i)})),e.length)for(let t=e.length-1;t>=0;t--)this.viewportsInfo.splice(e[t],1);const n={toolGroupId:this.id,viewportId:o,renderingEngineId:t};(0,d.triggerEvent)(d.eventTarget,i.Events.TOOLGROUP_VIEWPORT_REMOVED,n)}setActiveStrategy(t,o){const e=this._toolInstances[t];void 0!==e?e.setActiveStrategy(o):console.warn(`Tool ${t} not added to toolGroup, can't set tool configuration.`)}setToolMode(t,o,e={}){t?o!==i.ToolModes.Active?o!==i.ToolModes.Passive?o!==i.ToolModes.Enabled?o!==i.ToolModes.Disabled?console.warn("setToolMode: mode must be defined"):this.setToolDisabled(t):this.setToolEnabled(t):this.setToolPassive(t):this.setToolActive(t,e||this.restoreToolOptions[t]):console.warn("setToolMode: toolName must be defined")}setToolActive(t,o={}){const e=this._toolInstances[t];if(void 0===e)return void console.warn(`Tool ${t} not added to toolGroup, can't set tool mode.`);if(!e)return void console.warn(`'${t}' instance ${e} is not registered with this toolGroup, can't set tool mode.`);const n={bindings:[...this.toolOptions[t]?this.toolOptions[t].bindings:[],...o.bindings?o.bindings:[]].reduce(((t,o)=>{const e=void 0!==o.numTouchPoints,n=void 0!==o.mouseButton;return t.some((t=>T(t,o)))||!e&&!n||t.push(o),t}),[]),mode:h};this.toolOptions[t]=n,this._toolInstances[t].mode=h;const r=d.Settings.getRuntimeSettings().get("useCursors");if(this._hasMousePrimaryButtonBinding(o)&&r)this.setViewportsCursorByToolName(t);else{if(!this.getActivePrimaryMouseButtonTool()&&r){const t=c.MouseCursor.getDefinedCursor("default");this._setCursorForViewports(t)}}this._hasMousePrimaryButtonBinding(o)&&(null===this.prevActivePrimaryToolName?this.prevActivePrimaryToolName=t:this.prevActivePrimaryToolName=this.currentActivePrimaryToolName,this.currentActivePrimaryToolName=t),"function"==typeof e.onSetToolActive&&e.onSetToolActive(),this._renderViewports();const s={toolGroupId:this.id,toolName:t,toolBindingsOptions:o};(0,d.triggerEvent)(d.eventTarget,i.Events.TOOL_ACTIVATED,s),this._triggerToolModeChangedEvent(t,h,o)}setToolPassive(t,o){const e=this._toolInstances[t];if(void 0===e)return void console.warn(`Tool ${t} not added to toolGroup, can't set tool mode.`);const n=this.getToolOptions(t),i=Object.assign({bindings:n?n.bindings:[]},n,{mode:g}),r=Array.isArray(o?.removeAllBindings)?o.removeAllBindings:this.getDefaultPrimaryBindings();i.bindings=i.bindings.filter((t=>!0!==o?.removeAllBindings&&!r.some((o=>T(t,o)))));let s=g;0!==i.bindings.length&&(s=h,i.mode=s),this.toolOptions[t]=i,e.mode=s,"function"==typeof e.onSetToolPassive&&e.onSetToolPassive(),this._renderViewports(),this._triggerToolModeChangedEvent(t,g)}setToolEnabled(t){const o=this._toolInstances[t];if(void 0===o)return void console.warn(`Tool ${t} not added to toolGroup, can't set tool mode.`);const e={bindings:[],mode:p};this.toolOptions[t]=e,o.mode=p,"function"==typeof o.onSetToolEnabled&&o.onSetToolEnabled(),this._renderViewports(),this._triggerToolModeChangedEvent(t,p)}setToolDisabled(t){const o=this._toolInstances[t];if(void 0===o)return void console.warn(`Tool ${t} not added to toolGroup, can't set tool mode.`);const e={bindings:[],mode:f};this.restoreToolOptions[t]=this.toolOptions[t],this.toolOptions[t]=e,o.mode=f,"function"==typeof o.onSetToolDisabled&&o.onSetToolDisabled(),this._renderViewports(),this._triggerToolModeChangedEvent(t,f)}getToolOptions(t){const o=this.toolOptions[t];if(void 0!==o)return o}getActivePrimaryMouseButtonTool(){return Object.keys(this.toolOptions).find((t=>{const o=this.toolOptions[t];return o.mode===h&&this._hasMousePrimaryButtonBinding(o)}))}setViewportsCursorByToolName(t,o){const e=this._getCursor(t,o);this._setCursorForViewports(e)}_getCursor(t,o){let e,n;return o&&(e=`${t}.${o}`,n=c.SVGMouseCursor.getDefinedCursor(e,!0),n)?n:(e=`${t}`,n=c.SVGMouseCursor.getDefinedCursor(e,!0),n||(e=t,n=c.SVGMouseCursor.getDefinedCursor(e,!0),n||c.MouseCursor.getDefinedCursor("default")))}_setCursorForViewports(t){this.viewportsInfo.forEach((({renderingEngineId:o,viewportId:e})=>{const n=(0,d.getEnabledElementByIds)(e,o);if(!n)return;const{viewport:i}=n;(0,u.initElementCursor)(i.element,t)}))}setToolConfiguration(t,o,e){const n=this._toolInstances[t];if(void 0===n)return console.warn(`Tool ${t} not present, can't set tool configuration.`),!1;let i;return i=e?o:Object.assign(n.configuration,o),n.configuration=i,"function"==typeof n.onSetToolConfiguration&&n.onSetToolConfiguration(),this._renderViewports(),!0}getDefaultMousePrimary(){return i.MouseBindings.Primary}getDefaultPrimaryBindings(){return v}getToolConfiguration(t,o){if(void 0===this._toolInstances[t])return void console.warn(`Tool ${t} not present, can't set tool configuration.`);const e=s()(this._toolInstances[t].configuration,o)||this._toolInstances[t].configuration;return l()(e)}getPrevActivePrimaryToolName(){return this.prevActivePrimaryToolName}clone(t,o=null){let e=n.fT.getToolGroup(t);return e?(console.warn(`ToolGroup ${t} already exists`),e):(e=n.fT.createToolGroup(t),o=o??(()=>!0),Object.keys(this._toolInstances).filter(o).forEach((t=>{const o=this._toolInstances[t],n=this.toolOptions[t],i=o.mode;e.addTool(t),e.setToolMode(t,i,{bindings:n.bindings??[]})})),e)}_hasMousePrimaryButtonBinding(t){const o=this.getDefaultPrimaryBindings();return t?.bindings?.some((t=>o.some((o=>T(t,o)))))}_renderViewports(){this.viewportsInfo.forEach((({renderingEngineId:t,viewportId:o})=>{(0,d.getRenderingEngine)(t).renderViewport(o)}))}_triggerToolModeChangedEvent(t,o,e){const n={toolGroupId:this.id,toolName:t,mode:o,toolBindingsOptions:e};(0,d.triggerEvent)(d.eventTarget,i.Events.TOOL_MODE_CHANGED,n)}}function T(t,o){return t.mouseButton===o.mouseButton&&(t.numTouchPoints===o.numTouchPoints&&t.modifierKey===o.modifierKey)}const y=function(t){if(n.SB.toolGroups.some((o=>o.id===t)))return void console.warn(`'${t}' already exists.`);const o=new m(t);return n.SB.toolGroups.push(o),o}},878:(t,o,e)=>{"use strict";e.d(o,{Z:()=>r});var n=e(33232),i=e(85325);const r=function(){const t=[...n.SB.toolGroups];for(const o of t)(0,i.Z)(o.id);n.SB.toolGroups=[]}},85325:(t,o,e)=>{"use strict";e.d(o,{Z:()=>s});var n=e(33232),i=e(95482),r=e(31131);const s=function(t){const o=n.SB.toolGroups.findIndex((o=>o.id===t));o>-1&&(r.ZW.removeToolGroup(t),(0,i.removeSegmentationsFromToolGroup)(t),n.SB.toolGroups.splice(o,1))}},20568:(t,o,e)=>{"use strict";e.d(o,{Z:()=>i});var n=e(33232);const i=function(){return n.SB.toolGroups}},69160:(t,o,e)=>{"use strict";e.d(o,{Z:()=>i});var n=e(33232);const i=function(t){return n.SB.toolGroups.find((o=>o.id===t))}},24321:(t,o,e)=>{"use strict";e.d(o,{Z:()=>s});var n=e(33232),i=e(68096);const r=[i.ToolModes.Active,i.ToolModes.Passive,i.ToolModes.Enabled];const s=function(t){return n.SB.toolGroups.filter((({toolOptions:o})=>{const e=Object.keys(o);for(let n=0;n<e.length;n++)if(t===e[n]&&o[t]&&r.includes(o[t].mode))return!0;return!1}))}},22455:(t,o,e)=>{"use strict";e.d(o,{Z:()=>x});var n=e(62709),i=e(72076),r=e(39661),s=e(42975),a=e(79390),l=e(44037),d=e(90685),c=e(46966),u=e(66878),h=e(75698),g=e(89026),p=e(58391),f=e(21879),v=e(82571),m=e(54435),T=e(36705),y=e(86785),C=e(20724),w=e(42744),_=e(31955),b=e(20752),S=e(15607),I=e(51053),E=e(3042),B=e(22955),O=e(68096);const{pointCanProjectOnLine:M}=a.polyline,{EPSILON:P}=n.CONSTANTS,A=1-P;class N extends B.Z{constructor(t={},o={supportedInteractionTypes:["Mouse","Touch"],configuration:{shadow:!0,preventHandleOutsideImage:!1,contourHoleAdditionModifierKey:O.KeyboardBindings.Shift,alwaysRenderOpenContourHandles:{enabled:!1,radius:2},allowOpenContours:!0,closeContourProximity:10,checkCanvasEditFallbackProximity:6,makeClockWise:!0,subPixelResolution:4,smoothing:{smoothOnAdd:!1,smoothOnEdit:!1,knotsRatioPercentageOnAdd:40,knotsRatioPercentageOnEdit:40},interpolation:{enabled:!1,onInterpolationComplete:null},decimate:{enabled:!1,epsilon:.1},displayOnePointAsCrosshairs:!1,calculateStats:!0,getTextLines:D,statsCalculator:I.BasicStatsCalculator}}){super(t,o),this.isDrawing=!1,this.isEditingClosed=!1,this.isEditingOpen=!1,this.addNewAnnotation=t=>{const o=t.detail,{element:e}=o,i=(0,n.getEnabledElement)(e),{renderingEngine:r}=i,s=this.createAnnotation(t);this.addAnnotation(s,e);const a=(0,c.getViewportIdsWithToolToRender)(e,this.getToolName());return this.activateDraw(t,s,a),t.preventDefault(),(0,u.Z)(r,a),s},this.handleSelectedCallback=(t,o,e)=>{const n=t.detail,{element:i}=n,r=(0,c.getViewportIdsWithToolToRender)(i,this.getToolName());this.activateOpenContourEndEdit(t,o,r,e)},this.toolSelectedCallback=(t,o)=>{const e=t.detail,{element:n}=e,i=(0,c.getViewportIdsWithToolToRender)(n,this.getToolName());o.data.contour.closed?this.activateClosedContourEdit(t,o,i):this.activateOpenContourEdit(t,o,i),t.preventDefault()},this.isPointNearTool=(t,o,e,i)=>{const r=(0,n.getEnabledElement)(t),{viewport:s}=r,{polyline:a}=o.data.contour;let l=s.worldToCanvas(a[0]);for(let t=1;t<a.length;t++){const o=l,n=s.worldToCanvas(a[t]);if(M(e,o,n,i))return!0;l=n}if(!o.data.contour.closed)return!1;const d=s.worldToCanvas(a[0]),c=s.worldToCanvas(a[a.length-1]);return M(e,d,c,i)},this.cancel=t=>{const o=this.isDrawing,e=this.isEditingOpen,n=this.isEditingClosed;o?this.cancelDrawing(t):e?this.cancelOpenContourEdit(t):n&&this.cancelClosedContourEdit(t)},this._calculateCachedStats=(t,o,e,l)=>{const{data:d}=t,{cachedStats:c}=d,{polyline:u,closed:h}=d.contour,g=Object.keys(c);for(let l=0;l<g.length;l++){const p=g[l],f=this.getTargetIdImage(p,e);if(!f)continue;const{imageData:v,metadata:m}=f,T=u.map((t=>o.worldToCanvas(t))),y=T[0],C=o.canvasToWorld(y),I=o.canvasToWorld([y[0]+1,y[1]]),B=o.canvasToWorld([y[0],y[1]+1]),O=i.R3.distance(C,I),M=i.R3.distance(C,B),P=n.utilities.transformWorldToIndex(v,u[0]);P[0]=Math.floor(P[0]),P[1]=Math.floor(P[1]),P[2]=Math.floor(P[2]);let A=P[0],N=P[0],D=P[1],x=P[1],G=P[2],$=P[2];for(let t=1;t<u.length;t++){const o=n.utilities.transformWorldToIndex(v,u[t]);o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]),o[2]=Math.floor(o[2]),A=Math.min(A,o[0]),N=Math.max(N,o[0]),D=Math.min(D,o[1]),x=Math.max(x,o[1]),G=Math.min(G,o[2]),$=Math.max($,o[2])}const R=n.utilities.transformWorldToIndex(v,u[1]);R[0]=Math.floor(R[0]),R[1]=Math.floor(R[1]),R[2]=Math.floor(R[2]);const{scale:V,areaUnits:W}=(0,r.mh)(f,(()=>{const t=d.contour.polyline,e=t.length,i=new Array(e);for(let n=0;n<e;n++)i[n]=o.worldToCanvas(t[n]);const{maxX:r,maxY:a,minX:l,minY:c}=s.math.polyline.getAABB(i),u=o.canvasToWorld([l,c]),h=n.utilities.transformWorldToIndex(v,u),g=o.canvasToWorld([r,a]);return[h,n.utilities.transformWorldToIndex(v,g)]}));let k=a.polyline.getArea(T)/V/V;k*=O*M;const j=.01*(N-A),Z=.01*(x-D),U=.01*($-G);A=Math.floor(A-j),N=Math.ceil(N+j),D=Math.floor(D-Z),x=Math.ceil(x+Z),G=Math.floor(G-U),$=Math.ceil($+U);const F=[[A,N],[D,x],[G,$]],L=v.indexToWorld([N,x,$]),H=o.worldToCanvas(L);let K=0,Y=[],q=0;const X=(0,_.Z)(v,((t,e)=>{let n=!0;const i=o.worldToCanvas(t);return i[1]!=K&&(q=0,K=i[1],Y=(0,w.getLineSegmentIntersectionsCoordinates)(T,i,[H[0],i[1]]),Y.sort((function(t,o){return t[0]===o[0]?0:t[0]<o[0]?-1:1}))),Y.length&&i[0]>Y[0][0]&&(Y.shift(),q++),q%2==0&&(n=!1),n}),this.configuration.statsCalculator.statsCallback,F),z={isPreScaled:(0,b.P)(o,p),isSuvScaled:this.isSuvScaled(o,p,t.metadata.referencedImageId)},J=(0,S.F)(m.Modality,t.metadata.referencedImageId,z),Q=this.configuration.statsCalculator.getStatistics();c[p]={Modality:m.Modality,area:k,perimeter:(0,E.Z)(T,h),mean:Q.mean?.value,max:Q.max?.value,stdDev:Q.stdDev?.value,statsArray:Q.array,pointsInShape:X,areaUnit:W,modalityUnit:J}}return(0,T.hg)(t,l.viewport.element,O.ChangeTypes.StatsUpdated),t.invalidated=!1,c},this._renderStats=(t,o,e,n)=>{const{data:i}=t,r=this.getTargetId(o),s={toolGroupId:this.toolGroupId,toolName:this.getToolName(),viewportId:e.viewport.id},a=this.getLinkedTextBoxStyle(s,t);if(!a.visibility)return;const l=this.configuration.getTextLines(i,r);if(!l||0===l.length)return;const d=i.contour.polyline.map((t=>o.worldToCanvas(t)));if(!i.handles.textBox.hasMoved){const t=(0,C.getTextBoxCoordsCanvas)(d);i.handles.textBox.worldPosition=o.canvasToWorld(t)}const c=o.worldToCanvas(i.handles.textBox.worldPosition),u=(0,y.drawLinkedTextBox)(n,t.annotationUID??"","1",l,c,d,{},a),{x:h,y:g,width:p,height:f}=u;i.handles.textBox.worldBoundingBox={topLeft:o.canvasToWorld([h,g]),topRight:o.canvasToWorld([h+p,g]),bottomLeft:o.canvasToWorld([h,g+f]),bottomRight:o.canvasToWorld([h+p,g+f])}},(0,h.Z)(this),(0,g.Z)(this),(0,p.Z)(this),(0,f.Z)(this),(0,v.Z)(this),(0,m.Z)(this),this._throttledCalculateCachedStats=(0,d.Z)(this._calculateCachedStats,100,{trailing:!0})}filterInteractableAnnotationsForElement(t,o){if(!o||!o.length)return;const e=(0,n.getEnabledElement)(t),{viewport:i}=e;let r;if(i instanceof n.VolumeViewport){const t=i.getCamera(),{spacingInNormalDirection:e}=n.utilities.getTargetVolumeAndSpacingInNormalDir(i,t);r=this.filterAnnotationsWithinSlice(o,t,e)}else r=(0,l.filterAnnotationsForDisplay)(i,o);return r}filterAnnotationsWithinSlice(t,o,e){const{viewPlaneNormal:n}=o,r=t.filter((t=>{const o=t.metadata.viewPlaneNormal,e=Math.abs(i.R3.dot(n,o))>A;return o&&e}));if(!r.length)return[];const s=e/2,{focalPoint:a}=o,l=[];for(const t of r){const o=t.data.contour.polyline[0];if(!t.isVisible)continue;const e=i.R3.create();i.R3.sub(e,a,o);const r=i.R3.dot(e,n);Math.abs(r)<s&&l.push(t)}return l}isContourSegmentationTool(){return!1}createAnnotation(t){const o=t.detail.currentPoints.world,e=super.createAnnotation(t);return n.utilities.deepMerge(e,{data:{contour:{polyline:[[...o]]},label:"",cachedStats:{}},onInterpolationComplete:t=>{t.data.handles.points.length=0}})}getAnnotationStyle(t){return super.getAnnotationStyle(t)}renderAnnotationInstance(t){const{enabledElement:o,targetId:e,svgDrawingHelper:n}=t,i=t.annotation;let r=!1;const{viewport:s,renderingEngine:a}=o,l=this.isDrawing,d=this.isEditingOpen,c=this.isEditingClosed;if(l||d||c){const t=this.commonData.annotation.annotationUID;if(i.annotationUID===t)if(l)this.renderContourBeingDrawn(o,n,i);else if(c)this.renderClosedContourBeingEdited(o,n,i);else{if(!d)throw new Error(`Unknown ${this.getToolName()} annotation rendering state`);this.renderOpenContourBeingEdited(o,n,i)}else this.configuration.displayOnePointAsCrosshairs&&1===i.data.contour.polyline.length?this.renderPointContourWithMarker(o,n,i):this.renderContour(o,n,i);r=!0}else this.configuration.displayOnePointAsCrosshairs&&1===i.data.contour.polyline.length?this.renderPointContourWithMarker(o,n,i):this.renderContour(o,n,i);if(this.configuration.calculateStats)return this._calculateStatsIfActive(i,e,s,a,o),this._renderStats(i,s,o,n),r}_calculateStatsIfActive(t,o,e,n,i){const r=this.commonData?.annotation.annotationUID;if((t.annotationUID!==r||this.commonData?.movingTextBox)&&!this.commonData?.movingTextBox){const{data:r}=t;r.cachedStats[o]&&null!=r.cachedStats[o].areaUnit?t.invalidated&&this._throttledCalculateCachedStats(t,e,n,i):(r.cachedStats[o]={Modality:null,area:null,max:null,mean:null,stdDev:null,areaUnit:null},this._calculateCachedStats(t,e,n,i))}}}function D(t,o){const e=t.cachedStats[o],{area:n,mean:i,stdDev:r,perimeter:a,max:l,isEmptyArea:d,areaUnit:c,modalityUnit:u}=e||{},h=[];if(n){const t=d?"Area: Oblique not supported":`Area: ${(0,s.roundNumber)(n)} ${c}`;h.push(t)}return i&&h.push(`Mean: ${(0,s.roundNumber)(i)} ${u}`),Number.isFinite(l)&&h.push(`Max: ${(0,s.roundNumber)(l)} ${u}`),r&&h.push(`Std Dev: ${(0,s.roundNumber)(r)} ${u}`),a&&h.push(`Perimeter: ${(0,s.roundNumber)(a)} ${u}`),h}N.toolName="PlanarFreehandROI";const x=N},20406:(t,o,e)=>{"use strict";e.d(o,{Z:()=>m});var n=e(62709),i=e(74297),r=e(95482),s=e(39949),a=e(14305),l=e(27078),d=e(93382),c=e(61958),u=e(78859),h=e(83456),g=e(33232),p=e(51593);const f=p.Z.toolName;class v extends d.ml{constructor(t={},o={configuration:{}}){super(t,o),this.renderSegmentation=t=>{const o=(0,l.getToolGroup)(t);if(!o)return;const e=(0,a.getSegmentationRepresentations)(t);if(!e||0===e.length)return;const r=o.viewportsInfo.map((({renderingEngineId:t,viewportId:o})=>{const e=(0,n.getEnabledElementByIds)(o,t);if(e)return e.viewport})),s=e.map((o=>{const e=this._getMergedRepresentationsConfig(t),n=[],s={[i.default.Labelmap]:h.Pm,[i.default.Contour]:u.p,[i.default.Surface]:c.o};o.type===i.default.Contour&&this.addPlanarFreeHandToolIfAbsent(t);const a=s[o.type];for(const t of r){const i=a.render(t,o,e);n.push(i)}return n}));Promise.allSettled(s).then((()=>{r.forEach((t=>{t.render()}))}))}}onSetToolEnabled(){const t=this.toolGroupId,o=(0,a.getSegmentationRepresentations)(t);o&&0!==o.length&&o.forEach((o=>{(0,s.setSegmentationVisibility)(t,o.segmentationRepresentationUID,!0)}))}onSetToolDisabled(){const t=this.toolGroupId,o=(0,a.getSegmentationRepresentations)(t);o&&0!==o.length&&o.forEach((o=>{(0,s.setSegmentationVisibility)(t,o.segmentationRepresentationUID,!1)}))}addPlanarFreeHandToolIfAbsent(t){f in g.SB.tools||(0,g.LK)(p.Z);const o=(0,l.getToolGroup)(t);o.hasTool(f)||(o.addTool(f),o.setToolPassive(f))}_getMergedRepresentationsConfig(t){const o=r.config.getToolGroupSpecificConfig(t),e=r.config.getGlobalConfig();return n.utilities.deepMerge(e,o)}}v.toolName="SegmentationDisplay";const m=v},20346:(t,o,e)=>{var n="__lodash_hash_undefined__",i="[object Function]",r="[object GeneratorFunction]",s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/,l=/^\./,d=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c=/\\(\\)?/g,u=/^\[object .+?Constructor\]$/,h="object"==typeof e.g&&e.g&&e.g.Object===Object&&e.g,g="object"==typeof self&&self&&self.Object===Object&&self,p=h||g||Function("return this")();var f,v=Array.prototype,m=Function.prototype,T=Object.prototype,y=p["__core-js_shared__"],C=(f=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+f:"",w=m.toString,_=T.hasOwnProperty,b=T.toString,S=RegExp("^"+w.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),I=p.Symbol,E=v.splice,B=V(p,"Map"),O=V(Object,"create"),M=I?I.prototype:void 0,P=M?M.toString:void 0;function A(t){var o=-1,e=t?t.length:0;for(this.clear();++o<e;){var n=t[o];this.set(n[0],n[1])}}function N(t){var o=-1,e=t?t.length:0;for(this.clear();++o<e;){var n=t[o];this.set(n[0],n[1])}}function D(t){var o=-1,e=t?t.length:0;for(this.clear();++o<e;){var n=t[o];this.set(n[0],n[1])}}function x(t,o){for(var e,n,i=t.length;i--;)if((e=t[i][0])===(n=o)||e!=e&&n!=n)return i;return-1}function G(t,o){var e;o=function(t,o){if(Z(t))return!1;var e=typeof t;if("number"==e||"symbol"==e||"boolean"==e||null==t||F(t))return!0;return a.test(t)||!s.test(t)||null!=o&&t in Object(o)}(o,t)?[o]:Z(e=o)?e:W(e);for(var n=0,i=o.length;null!=t&&n<i;)t=t[k(o[n++])];return n&&n==i?t:void 0}function $(t){if(!U(t)||(o=t,C&&C in o))return!1;var o,e=function(t){var o=U(t)?b.call(t):"";return o==i||o==r}(t)||function(t){var o=!1;if(null!=t&&"function"!=typeof t.toString)try{o=!!(t+"")}catch(t){}return o}(t)?S:u;return e.test(function(t){if(null!=t){try{return w.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function R(t,o){var e,n,i=t.__data__;return("string"==(n=typeof(e=o))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?i["string"==typeof o?"string":"hash"]:i.map}function V(t,o){var e=function(t,o){return null==t?void 0:t[o]}(t,o);return $(e)?e:void 0}A.prototype.clear=function(){this.__data__=O?O(null):{}},A.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},A.prototype.get=function(t){var o=this.__data__;if(O){var e=o[t];return e===n?void 0:e}return _.call(o,t)?o[t]:void 0},A.prototype.has=function(t){var o=this.__data__;return O?void 0!==o[t]:_.call(o,t)},A.prototype.set=function(t,o){return this.__data__[t]=O&&void 0===o?n:o,this},N.prototype.clear=function(){this.__data__=[]},N.prototype.delete=function(t){var o=this.__data__,e=x(o,t);return!(e<0)&&(e==o.length-1?o.pop():E.call(o,e,1),!0)},N.prototype.get=function(t){var o=this.__data__,e=x(o,t);return e<0?void 0:o[e][1]},N.prototype.has=function(t){return x(this.__data__,t)>-1},N.prototype.set=function(t,o){var e=this.__data__,n=x(e,t);return n<0?e.push([t,o]):e[n][1]=o,this},D.prototype.clear=function(){this.__data__={hash:new A,map:new(B||N),string:new A}},D.prototype.delete=function(t){return R(this,t).delete(t)},D.prototype.get=function(t){return R(this,t).get(t)},D.prototype.has=function(t){return R(this,t).has(t)},D.prototype.set=function(t,o){return R(this,t).set(t,o),this};var W=j((function(t){var o;t=null==(o=t)?"":function(t){if("string"==typeof t)return t;if(F(t))return P?P.call(t):"";var o=t+"";return"0"==o&&1/t==-1/0?"-0":o}(o);var e=[];return l.test(t)&&e.push(""),t.replace(d,(function(t,o,n,i){e.push(n?i.replace(c,"$1"):o||t)})),e}));function k(t){if("string"==typeof t||F(t))return t;var o=t+"";return"0"==o&&1/t==-1/0?"-0":o}function j(t,o){if("function"!=typeof t||o&&"function"!=typeof o)throw new TypeError("Expected a function");var e=function(){var n=arguments,i=o?o.apply(this,n):n[0],r=e.cache;if(r.has(i))return r.get(i);var s=t.apply(this,n);return e.cache=r.set(i,s),s};return e.cache=new(j.Cache||D),e}j.Cache=D;var Z=Array.isArray;function U(t){var o=typeof t;return!!t&&("object"==o||"function"==o)}function F(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==b.call(t)}t.exports=function(t,o,e){var n=null==t?void 0:G(t,o);return void 0===n?e:n}}}]);
//# sourceMappingURL=497.bundle.a9c623965b40ba5853c9.js.map