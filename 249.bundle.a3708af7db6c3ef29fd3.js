"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[249],{37249:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var r=n(86326),a=n(97598),s=n.n(a),i=n(53562),l=n(7800),o=n(99993),c=n(27153),u=n(34321),m=n(11855);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(null,arguments)}const{formatDate:p}=i.utils;function f(e){const{displaySets:t,viewportIndex:n,viewportLabel:a,servicesManager:s,extensionManager:f,viewportOptions:E}=e,{t:g}=(0,o.Bd)("TrackedViewport"),{measurementService:v,cornerstoneViewportService:b}=s.services,S=t[0],[w]=(0,u.B)(),[h,x]=(0,r.useState)(!1),[y,I]=(0,r.useState)(null),[N,k]=(0,r.useState)(null),{trackedSeries:V}=w.context,D=E.viewportId,{SeriesDate:M,SeriesDescription:T,SeriesInstanceUID:P,SeriesNumber:O}=S,{PatientID:C,PatientName:R,PatientSex:_,PatientAge:A,SliceThickness:U,SpacingBetweenSlices:F,ManufacturerModelName:L}=S.images[0],j=(0,r.useCallback)((()=>{const e=b.getCornerstoneViewportByIndex(n);if(e instanceof m.BaseVolumeViewport){const t=e?.getCurrentImageId();if(!t)return void(h&&x(!1))}V.includes(P)!==h&&x(!h)}),[h,w,n,P]),B=(0,r.useCallback)((e=>{e.detail.element!==N&&(e.detail.element?.addEventListener(m.Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME,j),k(e.detail.element))}),[j,N]),W=(0,r.useCallback)((()=>{N?.removeEventListener(m.Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME,j)}),[j,N]);(0,r.useEffect)(j,[j]),(0,r.useEffect)((()=>{const{unsubscribe:e}=b.subscribe(b.EVENTS.VIEWPORT_DATA_CHANGED,(e=>{e.viewportIndex===n&&j()}));return()=>{e()}}),[j,n]),(0,r.useEffect)((()=>h?(c.annotation.config.style.setViewportToolStyles(D,{global:{lineDash:""}}),void b.getRenderingEngine().renderViewport(D)):(c.annotation.config.style.setViewportToolStyles(D,{global:{lineDash:"4,4"}}),b.getRenderingEngine().renderViewport(D),()=>{c.annotation.config.style.setViewportToolStyles(D,{})})),[h]);return r.createElement(r.Fragment,null,r.createElement(l.cS,{onDoubleClick:e=>{e.stopPropagation(),e.preventDefault()},useAltStyling:h,onArrowsClick:e=>function(e){const t=function(e,t,n,r){const{measurementService:a,viewportGridService:s}=t.services,i=a.getMeasurements(),{activeViewportIndex:l,viewports:o}=s.getState(),{displaySetInstanceUIDs:c}=o[l],{trackedSeries:u}=r.context,m=i.filter((e=>u.includes(e.referenceSeriesUID)&&c.includes(e.displaySetInstanceUID)));if(!m.length)return;const d=m.length,p=m.map((e=>e.uid));let f=p.findIndex((e=>e===n));return-1===f?f=0:"left"===e?(f--,f<0&&(f=d-1)):"right"===e&&(f++,f===d&&(f=0)),p[f]}(e,s,y,w);t&&(I(t),v.jumpToMeasurement(n,t))}(e),getStatusComponent:()=>function(e){const t=e?"status-tracked":"status-untracked";return r.createElement("div",{className:"relative"},r.createElement(l.m_,{position:"bottom-left",content:r.createElement("div",{className:"flex py-2"},r.createElement("div",{className:"flex pt-1"},r.createElement(l.In,{name:"info-link",className:"w-4 text-primary-main"})),r.createElement("div",{className:"flex ml-4"},r.createElement("span",{className:"text-base text-common-light"},e?r.createElement(r.Fragment,null,"Series is",r.createElement("span",{className:"font-bold text-white"}," tracked")," and can be viewed ",r.createElement("br",null)," in the measurement panel"):r.createElement(r.Fragment,null,"Measurements for",r.createElement("span",{className:"font-bold text-white"}," untracked "),"series ",r.createElement("br",null)," will not be shown in the ",r.createElement("br",null)," measurements panel"))))},r.createElement(l.In,{name:t,className:"text-primary-light"})))}(h),studyData:{label:a,studyDate:p(M),currentSeries:O,seriesDescription:T,patientInformation:{patientName:R?i.Ay.utils.formatPN(R):"",patientSex:_||"",patientAge:A||"",MRN:C||"",thickness:U?`${parseFloat(U).toFixed(2)}mm`:"",spacing:void 0!==F?`${parseFloat(F).toFixed(2)}mm`:"",scanner:L||""}}}),r.createElement("div",{className:"relative flex flex-row w-full h-full overflow-hidden"},(()=>{const{component:t}=f.getModuleEntry("@ohif/extension-cornerstone.viewportModule.cornerstone");return r.createElement(t,d({},e,{onElementEnabled:B,onElementDisabled:W}))})()))}f.propTypes={displaySets:s().arrayOf(s().object.isRequired).isRequired,viewportIndex:s().number.isRequired,dataSource:s().object,children:s().node,customProps:s().object},f.defaultProps={customProps:{}};const E=f}}]);
//# sourceMappingURL=249.bundle.a3708af7db6c3ef29fd3.js.map