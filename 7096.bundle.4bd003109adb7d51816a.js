/*! For license information please see 7096.bundle.4bd003109adb7d51816a.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[7096,7513],{97604:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(a=n.key,i=void 0,"symbol"==typeof(i=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?i:String(i)),n)}var a,i}function i(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e){for(var t=new Uint8Array(e.length),r=0,n=e.length;r<n;r++)t[r]=e.charCodeAt(r);return t}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r+t.length>e.length)return!1;for(var n=r,a=0;a<t.length;a++){if(t[a]!==e[n])return!1;n+=1}return!0}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,a=e.length;n&&(a=Math.min(r+n,e.length));for(var i=r;i<a;i++)if(e[i]===t[0]&&c(e,t,i))return i;return-1}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}(),r="Content-Type: ".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/dicom"),n="\r\n--".concat(t,"\r\n").concat(r,"\r\n\r\n"),a="\r\n--".concat(t,"--"),i=o(n),s=o(a),c=i.length,u=s.length,d=0,p=e.map((function(e){var t=new Uint8Array(e),r=t.length;return d+=c+r+u,t})),f=new Uint8Array(d);f.set(i,0);var l=0;return p.forEach((function(e){f.set(i,l),f.set(e,l+c),l+=c+e.length})),f.set(s,l),{data:f.buffer,boundary:t}}function p(e){var t=ArrayBuffer.isView(e)?e:new Uint8Array(e),r=o("\r\n\r\n"),n=u(t,r,0,1e3);if(-1===n)throw new Error("Response message has no multipart mime header");var a=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(arguments.length>2?arguments[2]:void 0)||e.length-t,n="",a=t;a<t+r;a++)n+=String.fromCharCode(e[a]);return n}(t,0,n),i=function(e){for(var t=e.split("\r\n"),r=0;r<t.length;r++)if("--"===t[r].substr(0,2))return t[r];return null}(a);if(!i)throw new Error("Header of response message does not specify boundary");for(var s,c=o(i),d=c.length,p=[],f=d;-1!==s&&-1!==(s=u(t,c,f));){var l=u(t,r,f,1e3);if(-1===l)throw new Error("Response message part has no mime header");f=l+r.length;var h=e.slice(f,s-2);p.push(h),f=s+d}return p}function f(e){return"object"===n(e)&&null!==e}function l(e){return 0===Object.keys(e).length&&e.constructor===Object}r.d(t,{api:()=>m});var h=function(e){return e[0]},v={DICOM:"application/dicom",DICOM_JSON:"application/dicom+json",OCTET_STREAM:"application/octet-stream",PDF:"application/pdf",JPEG:"image/jpeg",PNG:"image/png"},y=function(){};var m={DICOMwebClient:function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseURL=t.url,this.baseURL||console.error("no DICOMweb base url provided - calls that require a URL will fail"),"username"in t&&(this.username=t.username,"password"in t||console.error("no password provided to authenticate with DICOMweb service"),this.password=t.password),"qidoURLPrefix"in t?(y("use URL prefix for QIDO-RS: ".concat(t.qidoURLPrefix)),this.qidoURL="".concat(this.baseURL,"/").concat(t.qidoURLPrefix)):this.qidoURL=this.baseURL,"wadoURLPrefix"in t?(y("use URL prefix for WADO-RS: ".concat(t.wadoURLPrefix)),this.wadoURL="".concat(this.baseURL,"/").concat(t.wadoURLPrefix)):this.wadoURL=this.baseURL,"stowURLPrefix"in t?(y("use URL prefix for STOW-RS: ".concat(t.stowURLPrefix)),this.stowURL="".concat(this.baseURL,"/").concat(t.stowURLPrefix)):this.stowURL=this.baseURL,t.singlepart?(y("use singlepart",t.singlepart),this.singlepart=!0===t.singlepart?"bulkdata,video,image":t.singlepart):this.singlepart="","requestHooks"in t&&(this.requestHooks=t.requestHooks),this.headers=t.headers||{},this.errorInterceptor=t.errorInterceptor||function(){},this.verbose=!1!==t.verbose,this.setDebug(t.debug)}var t,r,s;return t=e,r=[{key:"setDebug",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.debugLevel=!!e,y=t||e?console.log:function(){}}},{key:"getDebug",value:function(){return this.debugLevel}},{key:"setVerbose",value:function(e){this.verbose=e}},{key:"getVerbose",value:function(){return this.verbose}},{key:"_httpRequest",value:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=this.errorInterceptor,o=this.requestHooks;return new Promise((function(c,u){var d=i.request?i.request:new XMLHttpRequest;d.open(t,e,!0),"responseType"in i&&(d.responseType=i.responseType),"object"===n(a)&&Object.keys(a).forEach((function(e){d.setRequestHeader(e,a[e])}));var f,l=r.headers;if(Object.keys(l).forEach((function(e){d.setRequestHeader(e,l[e])})),d.onloadstart=function(){y("upload started: ",e)},d.onloadend=function(){y("upload finished")},d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){var e=d.getResponseHeader("Content-Type");e&&-1!==e.indexOf("multipart")?c(p(d.response)):"arraybuffer"===d.responseType?c([d.response]):c(d.response)}else if(202===d.status)r.verbose&&console.warn("some resources already existed: ",d),c(d.response);else if(204===d.status)r.verbose&&console.warn("empty response for request: ",d),c([]);else{var t=new Error("request failed");t.request=d,t.response=d.response,t.status=d.status,r.verbose&&(console.error("request failed: ",d),console.error(t),console.error(t.response)),s(t),u(t)}},"progressCallback"in i&&"function"==typeof i.progressCallback&&(d.onprogress=i.progressCallback),o&&function(e){var t=Array.isArray(e)&&e.every((function(e){return"function"==typeof e&&2===e.length}));return t||console.warn("Request hooks should have the following signature: function requestHook(request, metadata) { return request; }"),t}(o)){var h=Object.assign({},a,r.headers),v={method:t,url:e,headers:h},m=(f=o,function(e){return f.reduce((function(e,t){return t(e,v)}),e)});d=m(d)}"withCredentials"in i&&i.withCredentials&&(d.withCredentials=!0),"data"in i?d.send(i.data):d.send()}))}},{key:"_httpGet",value:function(e,t,r,n,a){return this._httpRequest(e,"get",t,{responseType:r,progressCallback:n,withCredentials:a})}},{key:"_httpGetApplicationJson",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=t;"object"===n(r)&&(l(r)||(s+=e._parseQueryParameters(r)));var o={Accept:v.DICOM_JSON};return this._httpGet(s,o,"json",a,i)}},{key:"_httpGetApplicationPdf",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=t;"object"===n(r)&&(l(r)||(s+=e._parseQueryParameters(r)));var o={Accept:v.PDF};return this._httpGet(s,o,"json",a,i)}},{key:"_httpGetImage",value:function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,o=t;"object"===n(a)&&(l(a)||(o+=e._parseQueryParameters(a)));var c={Accept:e._buildAcceptHeaderFieldValue(r,["image/","image/*","image/jpeg","image/jp2","image/gif","image/png"])};return this._httpGet(o,c,"arraybuffer",i,s)}},{key:"_httpGetText",value:function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,o=t;"object"===n(a)&&(l(a)||(o+=e._parseQueryParameters(a)));var c={Accept:e._buildAcceptHeaderFieldValue(r,["text/","text/*","text/html","text/plain","text/rtf","text/xml"])};return this._httpGet(o,c,"arraybuffer",i,s)}},{key:"_httpGetVideo",value:function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,o=t;"object"===n(a)&&(l(a)||(o+=e._parseQueryParameters(a)));var c={Accept:e._buildAcceptHeaderFieldValue(r,["video/","video/*","video/mpeg","video/mp4","video/H265"])};return this._httpGet(o,c,"arraybuffer",i,s)}},{key:"_httpGetMultipartImage",value:function(t,r,n,a){var i,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,c={};return arguments.length>4&&void 0!==arguments[4]&&arguments[4]?i=["image/jpeg","image/gif","image/png","image/jp2"]:(i={"1.2.840.10008.1.2.5":["image/x-dicom-rle"],"1.2.840.10008.1.2.4.50":["image/jpeg"],"1.2.840.10008.1.2.4.51":["image/jpeg"],"1.2.840.10008.1.2.4.57":["image/jpeg"],"1.2.840.10008.1.2.4.70":["image/jpeg"],"1.2.840.10008.1.2.4.80":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.81":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.90":["image/jp2"],"1.2.840.10008.1.2.4.91":["image/jp2"],"1.2.840.10008.1.2.4.92":["image/jpx"],"1.2.840.10008.1.2.4.93":["image/jpx"]},n&&(c.Range=e._buildRangeHeaderFieldValue(n))),c.Accept=e._buildMultipartAcceptHeaderFieldValue(r,i),this._httpGet(t,c,"arraybuffer",s,o)}},{key:"_httpGetMultipartVideo",value:function(t,r,n,a){var i,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,c={};return arguments.length>4&&void 0!==arguments[4]&&arguments[4]?i=["video/","video/*","video/mpeg2","video/mp4","video/H265"]:(i={"1.2.840.10008.1.2.4.100":["video/mpeg2"],"1.2.840.10008.1.2.4.101":["video/mpeg2"],"1.2.840.10008.1.2.4.102":["video/mp4"],"1.2.840.10008.1.2.4.103":["video/mp4"],"1.2.840.10008.1.2.4.104":["video/mp4"],"1.2.840.10008.1.2.4.105":["video/mp4"],"1.2.840.10008.1.2.4.106":["video/mp4"]},n&&(c.Range=e._buildRangeHeaderFieldValue(n))),c.Accept=e._buildMultipartAcceptHeaderFieldValue(r,i),this._httpGet(t,c,"arraybuffer",s,o)}},{key:"_httpGetMultipartApplicationDicom",value:function(t,r,n,a,i){var s={},o="application/dicom",c={"1.2.840.10008.1.2.1":[o],"1.2.840.10008.1.2.5":[o],"1.2.840.10008.1.2.4.50":[o],"1.2.840.10008.1.2.4.51":[o],"1.2.840.10008.1.2.4.57":[o],"1.2.840.10008.1.2.4.70":[o],"1.2.840.10008.1.2.4.80":[o],"1.2.840.10008.1.2.4.81":[o],"1.2.840.10008.1.2.4.90":[o],"1.2.840.10008.1.2.4.91":[o],"1.2.840.10008.1.2.4.92":[o],"1.2.840.10008.1.2.4.93":[o],"1.2.840.10008.1.2.4.100":[o],"1.2.840.10008.1.2.4.101":[o],"1.2.840.10008.1.2.4.102":[o],"1.2.840.10008.1.2.4.103":[o],"1.2.840.10008.1.2.4.104":[o],"1.2.840.10008.1.2.4.105":[o],"1.2.840.10008.1.2.4.106":[o]},u=r;return r||(u=[{mediaType:o}]),s.Accept=e._buildMultipartAcceptHeaderFieldValue(u,c),this._httpGet(t,s,"arraybuffer",a,i)}},{key:"_httpGetMultipartApplicationOctetStream",value:function(t,r,n,a,s,o){var c={},u={"1.2.840.10008.1.2.1":i(Object.values(v))},d=r;return r||(d=[{mediaType:"application/octet-stream"}]),n&&(c.Range=e._buildRangeHeaderFieldValue(n)),c.Accept=e._buildMultipartAcceptHeaderFieldValue(d,u),this._httpGet(t,c,"arraybuffer",s,o)}},{key:"_httpPost",value:function(e,t,r,n,a,i){return this._httpRequest(e,"post",t,{data:r,progressCallback:n,withCredentials:a,request:i})}},{key:"_httpPostApplicationJson",value:function(e,t,r,n){var a={"Content-Type":v.DICOM_JSON};return this._httpPost(e,a,t,r,n)}},{key:"searchForStudies",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y("search for studies");var r=!1,n="".concat(this.qidoURL,"/studies");return"queryParams"in t&&(n+=e._parseQueryParameters(t.queryParams)),"withCredentials"in t&&t.withCredentials&&(r=t.withCredentials),this._httpGetApplicationJson(n,{},!1,r)}},{key:"retrieveStudyMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of study metadata");y("retrieve metadata of study ".concat(e.studyInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/metadata"),r=!1;return"withCredentials"in e&&e.withCredentials&&(r=e.withCredentials),this._httpGetApplicationJson(t,{},!1,r)}},{key:"searchForSeries",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.qidoURL;"studyInstanceUID"in t&&(y("search series of study ".concat(t.studyInstanceUID)),r+="/studies/".concat(t.studyInstanceUID)),r+="/series","queryParams"in t&&(r+=e._parseQueryParameters(t.queryParams));var n=!1;return"withCredentials"in t&&t.withCredentials&&(n=t.withCredentials),this._httpGetApplicationJson(r,{},!1,n)}},{key:"retrieveSeriesMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of series metadata");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required for retrieval of series metadata");y("retrieve metadata of series ".concat(e.seriesInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/series/").concat(e.seriesInstanceUID,"/metadata"),r=!1;return"withCredentials"in e&&e.withCredentials&&(r=e.withCredentials),this._httpGetApplicationJson(t,{},!1,r)}},{key:"searchForInstances",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.qidoURL,n=!1;return"studyInstanceUID"in t?(r+="/studies/".concat(t.studyInstanceUID),"seriesInstanceUID"in t?(y("search for instances of series ".concat(t.seriesInstanceUID)),r+="/series/".concat(t.seriesInstanceUID)):y("search for instances of study ".concat(t.studyInstanceUID))):y("search for instances"),r+="/instances","queryParams"in t&&(r+=e._parseQueryParameters(t.queryParams)),"withCredentials"in t&&t.withCredentials&&(n=t.withCredentials),this._httpGetApplicationJson(r,{},!1,n)}},{key:"buildInstanceWadoURIUrl",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required.");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required.");if(!("sopInstanceUID"in e))throw new Error("SOP Instance UID is required.");var t=e.contentType||v.DICOM,r=e.transferSyntax||"*",n=[];n.push("requestType=WADO"),n.push("studyUID=".concat(e.studyInstanceUID)),n.push("seriesUID=".concat(e.seriesInstanceUID)),n.push("objectUID=".concat(e.sopInstanceUID)),n.push("contentType=".concat(t)),n.push("transferSyntax=".concat(r));var a=n.join("&");return"".concat(this.wadoURL,"?").concat(a)}},{key:"retrieveInstanceMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of instance metadata");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required for retrieval of instance metadata");if(!("sopInstanceUID"in e))throw new Error("SOP Instance UID is required for retrieval of instance metadata");y("retrieve metadata of instance ".concat(e.sopInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/series/").concat(e.seriesInstanceUID,"/instances/").concat(e.sopInstanceUID,"/metadata"),r=!1;return"withCredentials"in e&&e.withCredentials&&(r=e.withCredentials),this._httpGetApplicationJson(t,{},!1,r)}},{key:"retrieveInstanceFrames",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of instance frames");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of instance frames");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of instance frames");if(!("frameNumbers"in t))throw new Error("frame numbers are required for retrieval of instance frames");y("retrieve frames ".concat(t.frameNumbers.toString()," of instance ").concat(t.sopInstanceUID));var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/frames/").concat(t.frameNumbers.toString()),n=t.mediaTypes,a=!1;"withCredentials"in t&&t.withCredentials&&(a=t.withCredentials);var i=!1;if("progressCallback"in t&&(i=t.progressCallback),!n)return this._httpGetMultipartApplicationOctetStream(r,!1,!1,!1,i,a);if(e._getSharedMediaTypes(n).length>1){var s={Accept:e._buildMultipartAcceptHeaderFieldValue(n,{"1.2.840.10008.1.2.1":["application/octet-stream"],"1.2.840.10008.1.2.5":["image/x-dicom-rle"],"1.2.840.10008.1.2.4.50":["image/jpeg"],"1.2.840.10008.1.2.4.51":["image/jpeg"],"1.2.840.10008.1.2.4.57":["image/jpeg"],"1.2.840.10008.1.2.4.70":["image/jpeg"],"1.2.840.10008.1.2.4.80":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.81":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.90":["image/jp2"],"1.2.840.10008.1.2.4.91":["image/jp2"],"1.2.840.10008.1.2.4.92":["image/jpx"],"1.2.840.10008.1.2.4.93":["image/jpx"],"1.2.840.10008.1.2.4.201":["image/jhc"],"1.2.840.10008.1.2.4.202":["image/jhc"]})};return this._httpGet(r,s,"arraybuffer",i,a)}var o=e._getCommonMediaType(n);if(o.startsWith("application"))return this._httpGetMultipartApplicationOctetStream(r,n,!1,!1,i,a);if(o.startsWith("image"))return this._httpGetMultipartImage(r,n,!1,!1,!1,i,a);if(o.startsWith("video"))return this._httpGetMultipartVideo(r,n,!1,!1,!1,i,a);throw new Error("Media type ".concat(o," is not supported for retrieval of frames."))}},{key:"retrieveInstanceRendered",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/rendered"),n=t.mediaTypes,a=t.queryParams,i=!1;"withCredentials"in t&&t.withCredentials&&(i=t.withCredentials);var s=!1;if("progressCallback"in t&&(s=t.progressCallback),!n)return a&&(r+=e._parseQueryParameters(a)),this._httpGet(r,{},"arraybuffer",s,i);var o=e._getCommonMediaType(n);if(o.startsWith("image"))return this._httpGetImage(r,n,a,s,i);if(o.startsWith("video"))return this._httpGetVideo(r,n,a,s,i);if(o.startsWith("text"))return this._httpGetText(r,n,a,s,i);if(o===v.PDF)return this._httpGetApplicationPdf(r,a,s,i);throw new Error("Media type ".concat(o," is not supported ")+"for retrieval of rendered instance.")}},{key:"retrieveInstanceThumbnail",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/thumbnail"),n=t.mediaTypes,a=t.queryParams,i=!1;"withCredentials"in t&&t.withCredentials&&(i=t.withCredentials);var s=!1;if("progressCallback"in t&&(s=t.progressCallback),!n)return a&&(r+=e._parseQueryParameters(a)),this._httpGet(r,{},"arraybuffer",s,i);var o=e._getCommonMediaType(n);if(o.startsWith("image"))return this._httpGetImage(r,n,a,s,i);throw new Error("Media type ".concat(o," is not supported ")+"for retrieval of rendered instance.")}},{key:"retrieveInstanceFramesRendered",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance frames");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance frames");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance frames");if(!("frameNumbers"in t))throw new Error("frame numbers are required for retrieval of rendered instance frames");y("retrieve rendered frames ".concat(t.frameNumbers.toString()," of instance ").concat(t.sopInstanceUID));var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/frames/").concat(t.frameNumbers.toString(),"/rendered"),n=t.mediaTypes,a=t.queryParams,i=!1;"withCredentials"in t&&t.withCredentials&&(i=t.withCredentials);var s=!1;if("progressCallback"in t&&(s=t.progressCallback),!n)return a&&(r+=e._parseQueryParameters(a)),this._httpGet(r,{},"arraybuffer",!1,i);var o=e._getCommonMediaType(n);if(o.startsWith("image"))return this._httpGetImage(r,n,a,s,i);if(o.startsWith("video"))return this._httpGetVideo(r,n,a,s,i);throw new Error("Media type ".concat(o," is not supported ")+"for retrieval of rendered frame.")}},{key:"retrieveInstanceFramesThumbnail",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance frames");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance frames");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance frames");if(!("frameNumbers"in t))throw new Error("frame numbers are required for retrieval of rendered instance frames");console.debug("retrieve rendered frames ".concat(t.frameNumbers.toString()," of instance ").concat(t.sopInstanceUID));var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/frames/").concat(t.frameNumbers.toString(),"/thumbnail"),n=t.mediaTypes,a=t.queryParams,i=!1;"withCredentials"in t&&t.withCredentials&&(i=t.withCredentials);var s=!1;if("progressCallback"in t&&(s=t.progressCallback),!n)return a&&(r+=e._parseQueryParameters(a)),this._httpGet(r,{},"arraybuffer",s,i);var o=e._getCommonMediaType(n);if(o.startsWith("image"))return this._httpGetImage(r,n,a,s,i);throw new Error("Media type ".concat(o," is not supported ")+"for retrieval of rendered frame.")}},{key:"retrieveInstance",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID),n=t.mediaTypes,a=t.withCredentials,i=void 0!==a&&a,s=t.progressCallback,o=void 0!==s&&s;if(!n)return this._httpGetMultipartApplicationDicom(r,!1,!1,o,i).then(h);var c=e._getCommonMediaType(n);if(c===v.DICOM)return this._httpGetMultipartApplicationDicom(r,n,!1,o,i).then(h);throw new Error("Media type ".concat(c," is not supported for retrieval of instance."))}},{key:"retrieveSeries",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID),n=t.mediaTypes,a=!1;"withCredentials"in t&&t.withCredentials&&(a=t.withCredentials);var i=!1;if("progressCallback"in t&&(i=t.progressCallback),!n)return this._httpGetMultipartApplicationDicom(r,!1,!1,i,a);var s=e._getCommonMediaType(n);if(s===v.DICOM)return this._httpGetMultipartApplicationDicom(r,n,!1,i,a);throw new Error("Media type ".concat(s," is not supported for retrieval of series."))}},{key:"retrieveStudy",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID),n=t.mediaTypes,a=t.withCredentials,i=void 0!==a&&a,s=t.progressCallback,o=void 0!==s&&s;if(!n)return this._httpGetMultipartApplicationDicom(r,!1,!1,o,i);var c=e._getCommonMediaType(n);if(c===v.DICOM)return this._httpGetMultipartApplicationDicom(r,n,!1,o,i);throw new Error("Media type ".concat(c," is not supported for retrieval of study."))}},{key:"retrieveBulkData",value:function(t){if(!("BulkDataURI"in t))throw new Error("BulkDataURI is required.");var r=t.BulkDataURI,n=t.mediaTypes,a=t.byteRange,i=t.withCredentials,s=void 0!==i&&i,o=t.progressCallback,c=void 0!==o&&o;if(-1!==this.singlepart.indexOf("bulkdata"))return this._httpGet(r,t.headers,"arraybuffer",null,s);if(n)try{if("image/"===e._getCommonMediaType(n))return this._httpGetMultipartImage(r,n,a,!1,!1,c,s)}catch(e){}return this._httpGetMultipartApplicationOctetStream(r,n,a,!1,c,s)}},{key:"storeInstances",value:function(e){if(!("datasets"in e))throw new Error("datasets are required for storing");var t="".concat(this.stowURL,"/studies");"studyInstanceUID"in e&&(t+="/".concat(e.studyInstanceUID));var r=d(e.datasets),n=r.data,a=r.boundary,i={"Content-Type":'multipart/related; type="application/dicom"; boundary="'.concat(a,'"')},s=e.withCredentials,o=void 0!==s&&s;return this._httpPost(t,i,n,e.progressCallback,o,e.request)}}],s=[{key:"_parseQueryParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="?";return Object.keys(e).forEach((function(r,n){0!==n&&(t+="&"),t+="".concat(r,"=").concat(encodeURIComponent(e[r]))})),t}},{key:"_assertMediaTypeIsValid",value:function(e){if(!e)throw new Error("Not a valid media type: ".concat(e));var t=e.indexOf("/");if(-1===t)throw new Error("Not a valid media type: ".concat(e));var r=e.slice(0,t);if(!["application","image","text","video"].includes(r))throw new Error("Not a valid media type: ".concat(e));if(e.slice(t+1).includes("/"))throw new Error("Not a valid media type: ".concat(e))}},{key:"_parseMediaType",value:function(t){return e._assertMediaTypeIsValid(t),t.split("/")}},{key:"_buildAcceptHeaderFieldValue",value:function(t,r){if(!Array.isArray(t))throw new Error("Acceptable media types must be provided as an Array");return t.map((function(t){var n=t.mediaType;if(e._assertMediaTypeIsValid(n),!r.includes(n))throw new Error("Media type ".concat(n," is not supported for requested resource"));return n})).join(", ")}},{key:"_buildMultipartAcceptHeaderFieldValue",value:function(t,r){var n=this;if(!Array.isArray(t))throw new Error("Acceptable media types must be provided as an Array");if(!Array.isArray(r)&&!f(r))throw new Error("Supported media types must be provided as an Array or an Object");var a=[];if(t.forEach((function(t){var i=t.transferSyntaxUID,s=t.mediaType;e._assertMediaTypeIsValid(s);var o='multipart/related; type="'.concat(s,'"');if(f(r)){if(!(Object.values(r).flat(1).includes(s)||s.endsWith("/*")&&s.endsWith("/")))return void y("Media type ".concat(s," is not supported for requested resource"));if(i){if("*"!==i){if(!Object.keys(r).includes(i))throw new Error("Transfer syntax ".concat(i," is not supported for requested resource"));var c=r[i];if(!c.includes(s)){var u=e._parseMediaType(s)[0];c.map((function(t){var r=e._parseMediaType(t)[0];if(u!==r||!s.endsWith("/*")&&!s.endsWith("/"))throw new Error("Transfer syntax ".concat(i," is not supported for requested resource"))}))}}o+="; transfer-syntax=".concat(i)}}else if(Array.isArray(r)&&!r.includes(s))return void(n.verbose&&console.warn("Media type ".concat(s," is not supported for requested resource")));a.push(o)})),!a.length)throw new Error("No acceptable media types found among ".concat(JSON.stringify(t)));return a.join(", ")}},{key:"_buildRangeHeaderFieldValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 1===e.length?"bytes=".concat(e[0],"-"):2===e.length?"bytes=".concat(e[0],"-").concat(e[1]):"bytes=0-"}},{key:"_getSharedMediaTypes",value:function(t){var r=new Set;return t&&t.length?(t.forEach((function(t){var n=t.mediaType,a=e._parseMediaType(n)[0];r.add("".concat(a,"/"))})),Array.from(r)):r}},{key:"_getCommonMediaType",value:function(t){if(!t||!t.length)throw new Error("No acceptable media types provided");var r=e._getSharedMediaTypes(t);if(0===r.length)throw new Error("No common acceptable media type could be identified.");if(r.length>1)throw new Error("Acceptable media types must have the same type.");return r[0]}}],r&&a(t.prototype,r),s&&a(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}()}},27318:e=>{"use strict";e.exports=function(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=r;return t}},8516:e=>{e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},87513:(e,t,r)=>{var n=r(27318),a=r(8516),i="undefined"!=typeof Float64Array;function s(e,t){return e[0]-t[0]}function o(){var e,t=this.stride,r=new Array(t.length);for(e=0;e<r.length;++e)r[e]=[Math.abs(t[e]),e];r.sort(s);var n=new Array(r.length);for(e=0;e<n.length;++e)n[e]=r[e][1];return n}function c(e,t){var r=["View",t,"d",e].join("");t<0&&(r="View_Nil"+e);var a="generic"===e;if(-1===t){var i="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";return new Function(i)()}if(0===t){i="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";return new Function("TrivialArray",i)(u[e][0])}i=["'use strict'"];var s=n(t),c=s.map((function(e){return"i"+e})),d="this.offset+"+s.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),p=s.map((function(e){return"b"+e})).join(","),f=s.map((function(e){return"c"+e})).join(",");i.push("function "+r+"(a,"+p+","+f+",d){this.data=a","this.shape=["+p+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),i.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+s.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),t<4?(i.push("function "+r+"_order(){"),2===t?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+r+"_set("+c.join(",")+",v){"),a?i.push("return this.data.set("+d+",v)}"):i.push("return this.data["+d+"]=v}"),i.push("proto.get=function "+r+"_get("+c.join(",")+"){"),a?i.push("return this.data.get("+d+")}"):i.push("return this.data["+d+"]}"),i.push("proto.index=function "+r+"_index(",c.join(),"){return "+d+"}"),i.push("proto.hi=function "+r+"_hi("+c.join(",")+"){return new "+r+"(this.data,"+s.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+s.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var l=s.map((function(e){return"a"+e+"=this.shape["+e+"]"})),h=s.map((function(e){return"c"+e+"=this.stride["+e+"]"}));i.push("proto.lo=function "+r+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+l.join(",")+","+h.join(","));for(var v=0;v<t;++v)i.push("if(typeof i"+v+"==='number'&&i"+v+">=0){d=i"+v+"|0;b+=c"+v+"*d;a"+v+"-=d}");i.push("return new "+r+"(this.data,"+s.map((function(e){return"a"+e})).join(",")+","+s.map((function(e){return"c"+e})).join(",")+",b)}"),i.push("proto.step=function "+r+"_step("+c.join(",")+"){var "+s.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+s.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(v=0;v<t;++v)i.push("if(typeof i"+v+"==='number'){d=i"+v+"|0;if(d<0){c+=b"+v+"*(a"+v+"-1);a"+v+"=ceil(-a"+v+"/d)}else{a"+v+"=ceil(a"+v+"/d)}b"+v+"*=d}");i.push("return new "+r+"(this.data,"+s.map((function(e){return"a"+e})).join(",")+","+s.map((function(e){return"b"+e})).join(",")+",c)}");var y=new Array(t),m=new Array(t);for(v=0;v<t;++v)y[v]="a[i"+v+"]",m[v]="b[i"+v+"]";i.push("proto.transpose=function "+r+"_transpose("+c+"){"+c.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+y.join(",")+","+m.join(",")+",this.offset)}"),i.push("proto.pick=function "+r+"_pick("+c+"){var a=[],b=[],c=this.offset");for(v=0;v<t;++v)i.push("if(typeof i"+v+"==='number'&&i"+v+">=0){c=(c+this.stride["+v+"]*i"+v+")|0}else{a.push(this.shape["+v+"]);b.push(this.stride["+v+"])}");return i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+s.map((function(e){return"shape["+e+"]"})).join(",")+","+s.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",i.join("\n"))(u[e],o)}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,r,n){if(void 0===e)return(0,u.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var s=t.length;if(void 0===r){r=new Array(s);for(var o=s-1,d=1;o>=0;--o)r[o]=d,d*=t[o]}if(void 0===n){n=0;for(o=0;o<s;++o)r[o]<0&&(n-=(t[o]-1)*r[o])}for(var p=function(e){if(a(e))return"buffer";if(i)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),f=u[p];f.length<=s+1;)f.push(c(p,f.length-1));return(0,f[s+1])(e,t,r,n)}},66898:e=>{"use strict";e.exports={eudist:function(e,t){for(var r=e.length,n=0,a=0;a<r;a++){var i=(e[a]||0)-(t[a]||0);n+=i*i}return n},mandist:function(e,t){for(var r=e.length,n=0,a=0,i=0;i<r;i++)n+=(a=(e[i]||0)-(t[i]||0))>=0?a:-a;return n},dist:function(e,t,r){var n=Math.abs(e-t);return r?n:n*n}}},1395:(e,t,r)=>{"use strict";var n=r(66898),a=n.eudist,i=n.dist;e.exports={kmrand:function(e,t){for(var r={},n=[],a=t<<2,i=e.length,s=e[0].length>0;n.length<t&&a-- >0;){var o=e[Math.floor(Math.random()*i)],c=s?o.join("_"):"".concat(o);r[c]||(r[c]=!0,n.push(o))}if(n.length<t)throw new Error("Error initializating clusters");return n},kmpp:function(e,t,r){var n=r||(e[0].length?a:i),s=[],o=e.length,c=e[0].length>0,u=e[Math.floor(Math.random()*o)];c?u.join("_"):"".concat(u);for(s.push(u);s.length<t;){for(var d=[],p=s.length,f=0,l=[],h=0;h<o;h++){for(var v=1/0,y=0;y<p;y++){var m=n(e[h],s[y]);m<=v&&(v=m)}d[h]=v}for(var g=0;g<o;g++)f+=d[g];for(var I=0;I<o;I++)l[I]={i:I,v:e[I],pr:d[I]/f,cs:0};l.sort((function(e,t){return e.pr-t.pr})),l[0].cs=l[0].pr;for(var w=1;w<o;w++)l[w].cs=l[w-1].cs+l[w].pr;for(var b=Math.random(),U=0;U<o-1&&l[U++].cs<b;);s.push(l[U-1].v)}return s}}},2196:(e,t,r)=>{"use strict";var n=r(66898),a=r(1395),i=n.eudist,s=(n.mandist,n.dist,a.kmrand),o=a.kmpp;function c(e,t,r){r=r||[];for(var n=0;n<e;n++)r[n]=t;return r}function u(e,t){for(var r=Array.isArray(e),n=this.centroids,a=n.length,s=1/0,o=0,c=0;c<a;c++){var u=t?t(e,n[c]):r?i(e,n[c]):Math.abs(e-n[c]);u<=s&&(s=u,o=c)}return{idx:o,centroid:n[o]}}e.exports=function(e,t,r,n,a){var d=[],p=[],f=[],l=[],h=!1,v=n||1e4,y=e.length,m=e[0].length,g=m>0,I=[];if(r)d="kmrand"==r?s(e,t):"kmpp"==r?o(e,t,a):r;else for(var w={},b=0;d.length<t;){var U=Math.floor(Math.random()*y);w[U]||(w[U]=!0,d[b++]=e[U])}do{c(t,0,I);for(var D=0;D<y;D++){for(var _=1/0,A=0,j=0;j<t;j++){(l=a?a(e[D],d[j]):g?i(e[D],d[j]):Math.abs(e[D]-d[j]))<=_&&(_=l,A=j)}f[D]=A,I[A]++}var C=[];p=[];if(g)for(var k=0;k<t;k++)C[k]=c(m,0,C[k]),p[k]=d[k];else for(var M=0;M<t;M++)C[M]=0,p[M]=d[M];if(g){for(var q=0;q<t;q++)d[q]=[];for(var S=0;S<y;S++)for(var R=C[f[S]],E=e[S],T=0;T<m;T++)R[T]+=E[T];h=!0;for(var P=0;P<t;P++){for(var O=d[P],x=C[P],G=p[P],L=I[P],F=0;F<m;F++)O[F]=x[F]/L||0;if(h)for(var V=0;V<m;V++)if(G[V]!=O[V]){h=!1;break}}}else{for(var H=0;H<y;H++){C[f[H]]+=e[H]}for(var N=0;N<t;N++)d[N]=C[N]/I[N]||0;h=!0;for(var W=0;W<t;W++)if(p[W]!=d[W]){h=!1;break}}h=h||--v<=0}while(!h);return{it:(n||1e4)-v,k:t,idxs:f,centroids:d,test:u}}},37202:(e,t,r)=>{"use strict";var n=r(87513);e.exports=function(e,t){t=t||"float64";for(var r=1,a=0;a<e.length;++a)r*=e[a];return n(new(function(e){switch(e){case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float":case"float32":return Float32Array;case"double":case"float64":return Float64Array;case"uint8_clamped":return Uint8ClampedArray;case"generic":case"buffer":case"data":case"dataview":return ArrayBuffer;case"array":return Array}}(t))(r),e)}}}]);
//# sourceMappingURL=7096.bundle.4bd003109adb7d51816a.js.map